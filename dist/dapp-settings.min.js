!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.dApp=t():e.dApp=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(14)),i=r(n(15)),s="function"==typeof fetch?fetch:n(16);function a(e){return e.text().then((function(t){return e.ok?i.default(t):Promise.reject(function(e){try{return JSON.parse(e)}catch(t){return e}}(t))}))}t.default=function(e){return s(o.default(e.url,e.base),function(e){void 0===e&&(e=Object.create(null));return e.credentials="include",e}(e.options)).then(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=function(e){return Array.isArray(e)?e:[e]},t.head=function(e){return e[0]},t.wait=function(e){return new Promise((function(t){setTimeout(t,e)}))},t.prop=function(e){return function(t){return t[e]}},t.keys=function(e){return Object.keys(e)},t.entries=function(e){return t.keys(e).map((function(t){return[t,e[t]]}))},t.values=function(e){return t.keys(e).map((function(t){return e[t]}))},t.assign=function(e,n){return t.entries(n).reduce((function(t,n){var r=n[0],o=n[1];return e[r]=o,e}),e)},t.map=function(e){return function(t){return t.map(e)}},t.filter=function(e){return function(t){return t.filter(e)}},t.indexBy=function(e,t){return t.reduce((function(t,n){return t[e(n)]=n,t}),{})},t.uniq=function(e){return t.keys(e.reduce((function(e,t){return e[t]=t,e}),Object.create(null)))},t.switchTransactionByType=function(e){return function(t){return e[t.type]&&"function"==typeof e[t.type]?e[t.type](t):void 0}},t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduce((function(e,t){return t(e)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MAP={3:"issue",4:"transfer",5:"reissue",6:"burn",7:"exchange",8:"lease",9:"cancelLease",10:"alias",11:"massTransfer",12:"data",13:"setScript",14:"sponsorship",15:"setAssetScript",16:"invoke"},t.NAME_MAP={issue:3,transfer:4,reissue:5,burn:6,exchange:7,lease:8,cancelLease:9,alias:10,massTransfer:11,data:12,setScript:13,sponsorship:14,setAssetScript:15,invoke:16},t.DEFAULT_OPTIONS={NODE_URL:"https://nodes.wavesplatform.com",MATCHER_URL:"https://nodes.wavesplatfomr.com/matcher"},t.DEFAULT_BROADCAST_OPTIONS={chain:!1,confirmations:-1},t.MAX_ALIAS_LENGTH=30,t.SMART_ASSET_EXTRA_FEE=.004*Math.pow(10,8)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){void 0===t&&(t=Object.create(null));var n=Object.keys(e).map((function(t){return[t,e[t]]})).map((function(e){var n=e[0],r=e[1];return[n,Object.prototype.hasOwnProperty.call(t,n)?t[n](r):r]})).filter((function(e){e[0];return null!=e[1]})).map((function(e){return e[0]+"="+e[1]})).join("&");return n.length?"?"+n:""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=n(6);t.default=function(e,t,n){var s=!Array.isArray(t),a=Date.now(),u=[],c=n&&n.confirmations||0,f=n&&n.maxWaitTime||0,l=n&&n.requestInterval||250,d=function(t){return o.fetchStatus(e,t.map(r.prop("id"))).then((function(e){var n=r.indexBy(r.prop("id"),e.statuses);if(t.some((function(e){return n[e.id].status===i.TRANSACTION_STATUSES.NOT_FOUND})))throw new Error("One transaction is not in blockchain!");var o=t.filter((function(e){return!(n[e.id].confirmations>=c)||(u.push(e),!1)}));if(o.length)return f&&Date.now()-a>f?Promise.reject("Timeout error!"):r.wait(l).then((function(){return d(o)}))}))};return d(r.toArray(t)).then((function(){return s?r.head(u):u}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),s=n(7),a=o(n(0)),u=o(n(3)),c=o(n(18));function f(e,t){return a.default({base:e,url:"/transactions/unconfirmed/info/"+t})}function l(e,t){return a.default({base:e,url:"/transactions/info/"+t})}t.fetchUnconfirmedSize=function(e){return a.default({base:e,url:"/transactions/unconfirmed/size"})},t.fetchCalculateFee=function(e,t){return a.default({base:e,url:"/transactions/calculateFee",options:{method:"POST",body:c.default(t),headers:{"Content-Type":"application/json"}}})},t.fetchUnconfirmed=function(e){return a.default({base:e,url:"/transactions/unconfirmed"})},t.fetchTransactions=function(e,t,n,r,o){return a.default({base:e,url:"/transactions/address/"+t+"/limit/"+n+u.default({after:r})}).then((function(e){return e[0]}))},t.fetchUnconfirmedInfo=f,t.fetchInfo=l,t.fetchStatus=function(e,t){var n={id:"",confirmations:-1,height:-1,inUTX:!1,status:i.TRANSACTION_STATUSES.NOT_FOUND},o=t.map((function(t){return f(e,t).then((function(){return r(r({},n),{id:t,status:i.TRANSACTION_STATUSES.UNCONFIRMED,inUTX:!0})})).catch((function(){return l(e,t).then((function(e){return r(r({},n),{id:t,status:i.TRANSACTION_STATUSES.IN_BLOCKCHAIN,height:e.height})}))})).catch((function(){return r(r({},n),{id:t})}))}));return Promise.all([s.fetchHeight(e),Promise.all(o)]).then((function(e){var t=e[0].height,n=e[1];return{height:t,statuses:n.map((function(e){return r(r({},e),{confirmations:e.status===i.TRANSACTION_STATUSES.IN_BLOCKCHAIN?t-e.height:e.confirmations})}))}}))},t.broadcast=function(e,t){return a.default({base:e,url:"/transactions/broadcast",options:{method:"POST",body:c.default(t),headers:{"Content-Type":"application/json"}}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MAP={3:"issue",4:"transfer",5:"reissue",6:"burn",7:"exchange",8:"lease",9:"cancelLease",10:"alias",11:"massTransfer",12:"data",13:"setScript",14:"sponsorship",15:"setAssetScript",16:"invoke"},t.NAME_MAP={issue:3,transfer:4,reissue:5,burn:6,exchange:7,lease:8,cancelLease:9,alias:10,massTransfer:11,data:12,setScript:13,sponsorship:14,setAssetScript:15,invoke:16},t.TRANSACTION_STATUSES={IN_BLOCKCHAIN:"in_blockchain",UNCONFIRMED:"unconfirmed",NOT_FOUND:"not_found"}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0));t.fetchHeadersSeq=function(e,t,n){return o.default({base:e,url:"/blocks/headers/seq/"+t+"/"+n})},t.fetchHeadersLast=function(e,t){return o.default({base:e,url:"/blocks/headers/last"})},t.fetchHeightBySignature=function(e,t){return o.default({base:e,url:"/blocks/height/"+t})},t.fetchHeadersAt=function(e,t,n){return o.default({base:e,url:"/blocks/headers/at/"+t})},t.BlockAt=function(e,t){return o.default({base:e,url:"/blocks/at/"+t})},t.fetchSeq=function(e,t,n){return o.default({base:e,url:"/blocks/seq/"+t+"/"+n})},t.fetchBlockBySignature=function(e,t){return o.default({base:e,url:"/blocks/signature/"+t})},t.fetchFirst=function(e){return o.default({base:e,url:"/blocks/first"})},t.fetchBlocksByAddress=function(e,t,n,r){return o.default({base:e,url:"/blocks/address/"+t+"/"+n+"/"+r})},t.fetchLast=function(e){return o.default({base:e,url:"/blocks/last"})},t.fetchDelay=function(e,t,n){return o.default({base:e,url:"/blocks/delay/"+t+"/"+n})},t.fetchHeight=function(e){return o.default({base:e,url:"/blocks/height"})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(9)),i=new(r(n(21)).default);t.waves=new o.default,t.waves.setProvider(i),t.donate=function(e,n){var r=document.querySelector(".waves__donate-label");t.waves.transfer({recipient:e.getAttribute("data-recipient"),amount:n,assetId:"WAVES"}).broadcast().then((function(){r.innerHTML="Thanks for your donation!"}),(function(e){r.innerHTML="An error occurred. Check the console!",console.log(e)}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),s=n(10),a=n(12),u=n(13),c=n(17),f=n(4),l=n(19),d=n(20),p=function(){function e(e){this._options=r(r({},i.DEFAULT_OPTIONS),e||{}),this._networkBytePromise=d.default(this._options.NODE_URL).then((function(e){return e}))}return Object.defineProperty(e.prototype,"_connectPromise",{get:function(){return this.__connectPromise||Promise.reject("Has no provider!")},set:function(e){this.__connectPromise=e},enumerable:!0,configurable:!0}),e.prototype.getNetworkByte=function(){return this._networkBytePromise},e.prototype.setProvider=function(e){var t=this;this.currentProvider=e;var n=this._networkBytePromise.then((function(n){return e.connect({NODE_URL:t._options.NODE_URL,NETWORK_BYTE:n})}));return this._connectPromise=n.then((function(){return e})),n},e.prototype.getBalance=function(){if(!this._userData)return Promise.reject(new Error("Need login for get balances!"));var e=this._userData;return Promise.all([u.fetchBalanceDetails(this._options.NODE_URL,e.address).then((function(e){return{assetId:"WAVES",assetName:"Waves",decimals:8,amount:String(e.available),isMyAsset:!1,tokens:Number(e.available)*Math.pow(10,8),sponsorship:null,isSmart:!1}})),c.fetchAssetsBalance(this._options.NODE_URL,e.address).then((function(t){return t.balances.map((function(t){return{assetId:t.assetId,assetName:t.issueTransaction.name,decimals:t.issueTransaction.decimals,amount:String(t.balance),isMyAsset:t.issueTransaction.sender===e.address,tokens:t.balance*Math.pow(10,t.issueTransaction.decimals),isSmart:!!t.issueTransaction.script,sponsorship:null!=t.sponsorBalance&&t.sponsorBalance>Math.pow(10,8)&&(t.minSponsoredAssetFee||0)<t.balance?t.minSponsoredAssetFee:null}}))}))]).then((function(e){var t=e[0],n=e[1];return o([t],n)}))},e.prototype.login=function(){var e=this;return this._connectPromise.then((function(e){return e.login()})).then((function(t){return e._userData=t,t}))},e.prototype.logout=function(){var e=this;return this._connectPromise.then((function(e){return e.logout()})).then((function(){e._userData=void 0}))},e.prototype.signMessage=function(e){return this._connectPromise.then((function(t){return t.signMessage(e)}))},e.prototype.signTypedData=function(e){return this._connectPromise.then((function(t){return t.signTypedData(e)}))},e.prototype.getSponsoredBalances=function(){return this.getBalance().then((function(e){return e.filter((function(e){return!!e.sponsorship}))}))},e.prototype.batch=function(e){var t=this,n=!Array.isArray(e),r=function(){return t._sign(s.toArray(e)).then((function(e){return n?e[0]:e}))};return{sign:r,broadcast:function(e){return r().then((function(n){return t.broadcast(n,e)}))}}},e.prototype.issue=function(e){return this._createPipelineAPI([a.addParamType("issue",e)])},e.prototype.transfer=function(e){return this._createPipelineAPI([a.addParamType("transfer",e)])},e.prototype.reissue=function(e){return this._createPipelineAPI([a.addParamType("reissue",e)])},e.prototype.burn=function(e){return this._createPipelineAPI([a.addParamType("burn",e)])},e.prototype.lease=function(e){return this._createPipelineAPI([a.addParamType("lease",e)])},e.prototype.exchange=function(e){return this._createPipelineAPI([a.addParamType("exchange",e)])},e.prototype.cancelLease=function(e){return this._createPipelineAPI([a.addParamType("cancelLease",e)])},e.prototype.alias=function(e){return this._createPipelineAPI([a.addParamType("alias",e)])},e.prototype.massTransfer=function(e){return this._createPipelineAPI([a.addParamType("massTransfer",e)])},e.prototype.data=function(e){return this._createPipelineAPI([a.addParamType("data",e)])},e.prototype.sponsorship=function(e){return this._createPipelineAPI([a.addParamType("sponsorship",e)])},e.prototype.setScript=function(e){return this._createPipelineAPI([a.addParamType("setScript",e)])},e.prototype.setAssetScript=function(e){return this._createPipelineAPI([a.addParamType("setAssetScript",e)])},e.prototype.invoke=function(e){return this._createPipelineAPI([a.addParamType("invoke",e)])},e.prototype.broadcast=function(e,t){return l.default(this._options.NODE_URL,e,t)},e.prototype.waitTxConfirm=function(e,t){return f.default(this._options.NODE_URL,e,{confirmations:t})},e.prototype._createPipelineAPI=function(e){var t=this,n=s.evolve(i.NAME_MAP,(function(n,i){return function(n){return t._createPipelineAPI(o(e,[r({type:i},n)]))}}));return r(r({},n),this._createActions(e))},e.prototype._createActions=function(e){var t=this,n=function(){return t._sign(e)};return{sign:n,broadcast:function(e){return n().then((function(n){return t.broadcast(n,e)}))}}},e.prototype._sign=function(e){return this._connectPromise.then((function(t){return t.sign(e)}))},e}();t.Waves=p,t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.toArray=function(e){return Array.isArray(e)?e:[e]},t.wait=function(e){return new Promise((function(t){setTimeout(t,e)}))},t.evolve=function(e,t){return r.entries(e).reduce((function(e,n){var r=n[0],o=n[1];return e[r]=t(r,o),e}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keys=function(e){return Object.keys(e)},t.entries=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))},t.values=function(e){return Object.keys(e).map((function(t){return e[t]}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2);t.addParamType=function(e,t){return r(r({},t),{type:o.NAME_MAP[e]})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=r(n(3));t.fetchDataKey=function(e,t,n,r){return o.default({base:e,url:"/addresses/data/"+t+"/"+encodeURIComponent(n)})},t.fetchScriptInfoMeta=function(e,t,n){return o.default({base:e,url:"/addresses/scriptInfo/"+t+"/meta"})},t.fetchBalanceDetails=function(e,t,n){return o.default({base:e,url:"/addresses/balance/details/"+t})},t.fetchBalanceConfirmations=function(e,t,n,r){return o.default({base:e,url:"/addresses/balance/"+t+"/"+n})},t.fetchScriptInfo=function(e,t,n){return o.default({base:e,url:"/addresses/scriptInfo/"+t})},t.data=function(e,t,n,r){return void 0===n&&(n=Object.create(null)),o.default({base:e,url:"/addresses/data/"+t+i.default(n)})},t.fetchValidate=function(e,t,n){return o.default({base:e,url:"/addresses/validate/"+t})},t.fetchBalance=function(e,t,n){return o.default({base:e,url:"/addresses/balance/"+t})},t.fetchEffectiveBalanceConfirmations=function(e,t,n){return o.default({base:e,url:"/addresses/effectiveBalance/"+t+"/"+n})},t.fetchEffectiveBalance=function(e,t){return o.default({base:e,url:"/addresses/effectiveBalance/"+t})},t.fetchSeq=function(e,t,n){return o.default({base:e,url:"/addresses/seq/"+t+"/"+n})},t.fetchSeed=function(e,t){return o.default({base:e,url:"/addresses/seed/"+t})},t.fetchPublicKey=function(e,t){return o.default({base:e,url:"/addresses/publicKey/"+t})},t.fetchAddresses=function(e){return o.default({base:e,url:"/addresses"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return new URL(e,t).toString()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new RegExp('((?!\\\\)"\\w+"):\\s*(-?[\\d|\\.]{14,})',"g");t.default=function(e){return JSON.parse(e.replace(r,'$1:"$2"'))}},function(e,t,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();e.exports=t=r.fetch,t.default=r.fetch.bind(r),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=n(1);t.fetchDetails=function(e,t){var n=!Array.isArray(t);return Promise.all(i.toArray(t).map((function(t){return o.default({base:e,url:"/assets/details/"+t})}))).then((function(e){return n?e[0]:e}))},t.fetchAssetDistribution=function(e,t,n,r){return o.default({base:e,url:"/assets/"+t+"/distribution/"+n+"/limit/"+r})},t.fetchAssetsAddressLimit=function(e,t,n){return o.default({base:e,url:"assets/nft/"+t+"/limit/"+n})},t.fetchAssetsBalance=function(e,t){return o.default({base:e,url:"/assets/balance/"+t})},t.fetchBalanceAddressAssetId=function(e,t,n){return o.default({base:e,url:"/assets/balance/"+t+"/"+n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new RegExp('(?!\\\\)"('+["value","amount","matcherFee","price","fee","minSponsoredAssetFee","quantity","sellMatcherFee","buyMatcherFee"].join("|")+')":\\s*"(-?\\d+)"',"g");t.default=function(e){return JSON.stringify(e).replace(r,'"$1":$2')}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(1),a=o(n(4)),u={chain:!1,confirmations:-1,maxWaitTime:0,requestInterval:0};t.default=function(e,t,n){var o=r(r({},u),n||{}),c=!Array.isArray(t),f=o.confirmations>0?1:0;return(o.chain?function(e,t,n){return new Promise((function(r,o){var s=t.slice().reverse(),u=[],c=function(){if(!s.length)return r(u),null;var t=s.pop();i.broadcast(e,t).then((function(t){return a.default(e,t,n)})).then((function(e){u.push(e),c()}),o)};c()}))}(e,s.toArray(t),r(r({},o),{confirmations:f})):function(e,t){return Promise.all(t.map((function(t){return i.broadcast(e,t)})))}(e,s.toArray(t))).then((function(t){return o.confirmations<=0?t:a.default(e,t,o)})).then((function(e){return c?s.head(e):e}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);t.default=function(e){return r.fetchHeadersLast(e).then((function(e){return function(e){var t,n,r,o,s;if(0===e.length)return new Uint8Array(0);s=void 0,o=void 0,t=[0],s=0;for(;s<e.length;){if(!((n=e[s])in i))throw"Base58.decode received unacceptable input. Character '"+n+"' is not in the Base58 alphabet.";for(o=0;o<t.length;)t[o]*=58,o++;for(t[0]+=i[n],r=0,o=0;o<t.length;)t[o]+=r,r=t[o]>>8,t[o]&=255,++o;for(;r;)t.push(255&r),r>>=8;s++}s=0;for(;"1"===e[s]&&s<e.length-1;)t.push(0),s++;return new Uint8Array(t.reverse())}(e.generator)[1]}))};for(var o="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",i={},s=0;s<o.length;s++)i[o.charAt(s)]=s},function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return o})),n.d(t,"__assign",(function(){return i})),n.d(t,"__rest",(function(){return s})),n.d(t,"__decorate",(function(){return a})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return f})),n.d(t,"__generator",(function(){return l})),n.d(t,"__exportStar",(function(){return d})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return h})),n.d(t,"__spread",(function(){return _})),n.d(t,"__spreadArrays",(function(){return y})),n.d(t,"__await",(function(){return v})),n.d(t,"__asyncGenerator",(function(){return b})),n.d(t,"__asyncDelegator",(function(){return m})),n.d(t,"__asyncValues",(function(){return g})),n.d(t,"__makeTemplateObject",(function(){return w})),n.d(t,"__importStar",(function(){return P})),n.d(t,"__importDefault",(function(){return O}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function a(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function d(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function y(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function b(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=o[e](t)).value instanceof v?Promise.resolve(n.value.v).then(u,c):f(i[0][2],n)}catch(e){f(i[0][3],e)}var n}function u(e){a("next",e)}function c(e){a("throw",e)}function f(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function m(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:v(e[r](t)),done:"return"===r}:o?o(t):t}:o}}function g(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function O(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(12)),r(n(6)),r(n(16)),r(n(7)),r(n(5)),r(n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keys=function(e){return Object.keys(e)};var r=Math.floor(Date.now()*Math.random()),o=0;t.uniqueId=function(e){return e+"-"+r+"-"+o++},t.toArray=function(e){return Array.isArray(e)?e:[e]},t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduce((function(e,t){return t(e)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(11),i=function(){function e(e){this.queue=new o.Queue(e)}return e.prototype.dialog=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,o,i,s=this;return r.__generator(this,(function(a){switch(a.label){case 0:return this.runBeforeShow(),[4,this.getBus()];case 1:if(t=a.sent(),n=function(){return r.__awaiter(s,void 0,void 0,(function(){return r.__generator(this,(function(n){return[2,e(t)]}))}))},!this.queue.canPush())return[3,6];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.queue.push(n)];case 3:return o=a.sent(),this.runAfterShow(),[2,o];case 4:return i=a.sent(),this.runAfterShow(),[2,Promise.reject(i)];case 5:return[3,7];case 6:return[2,Promise.reject(new Error("Queue is full!"))];case 7:return[2]}}))}))},e.prototype.runBeforeShow=function(){0===this.queue.length&&this.beforeShow()},e.prototype.runAfterShow=function(){0===this.queue.length&&this.afterShow()},e}();t.Transport=i},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(2)),r(n(13)),r(n(15))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){!function(e){e.LOG_LEVEL={PRODUCTION:0,ERRORS:1,VERBOSE:2},e.logLevel=e.LOG_LEVEL.PRODUCTION,e.methodsData={log:{save:!1,logLevel:e.LOG_LEVEL.VERBOSE},info:{save:!1,logLevel:e.LOG_LEVEL.VERBOSE},warn:{save:!1,logLevel:e.LOG_LEVEL.VERBOSE},error:{save:!0,logLevel:e.LOG_LEVEL.ERRORS}}}(e.console||(e.console={}))}(t.config||(t.config={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Adapter=function(){}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(n,r){var o=e.call(this)||this;return o.win=n,o.type=r,o.handler=function(e){o.trigger("message",e)},r===t.PROTOCOL_TYPES.LISTEN&&o.win.addEventListener("message",o.handler,!1),o}var n;return o(t,e),t.prototype.dispatch=function(e){return this.win.postMessage(e,"*"),this},t.prototype.destroy=function(){this.type===t.PROTOCOL_TYPES.LISTEN&&this.win.removeEventListener("message",this.handler,!1),this.win=t._fakeWin},t._fakeWin={postMessage:n=function(){return null},addEventListener:n,removeEventListener:n},t}(n(17).EventEmitter);t.WindowProtocol=i,function(e){e.PROTOCOL_TYPES={LISTEN:"listen",DISPATCH:"dispatch"}}(i=t.WindowProtocol||(t.WindowProtocol={})),t.WindowProtocol=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.StorageProvider=r.StorageProvider,t.default=r.StorageProvider},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(10),i=n(19),s=n(1),a=function(){function e(e,t){e=e||"https://waves.exchange/signer";var n=o.TransportIframe.canUse()?o.TransportIframe:i.TransportWindow;this._transport=new n(e,3),null!=t&&(s.config.console.logLevel=s.config.console.LOG_LEVEL.VERBOSE)}return e.prototype.connect=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,Promise.resolve(this._transport.event((function(t){return t.dispatchEvent("connect",e)})))]}))}))},e.prototype.logout=function(){return this._transport.dialog((function(e){return e.request("logout")}))},e.prototype.login=function(){return this._transport.dialog((function(e){return e.request("login")}))},e.prototype.signMessage=function(e){return this._transport.dialog((function(t){return t.request("sign-message",e)}))},e.prototype.signTypedData=function(e){return this._transport.dialog((function(t){return t.request("sign-typed-data",e)}))},e.prototype.sign=function(e){return this._transport.dialog((function(t){return t.request("sign",e)}))},e}();t.StorageProvider=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(3),i=n(1),s=function(e){function t(n,r){var o=e.call(this,r)||this;return o._iframe=t._createIframe(n),o._ready=i.WindowAdapter.createSimpleWindowAdapter(o._iframe).then((function(e){return o._hideIframe(),new i.Bus(e,-1)})),o._addIframeToDom(),o}return r.__extends(t,e),t.canUse=function(){var e=navigator.userAgent.toLowerCase(),t=e.includes("safari")&&!e.includes("chrome");return!(null!=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)||t)},t._createIframe=function(e){var t=document.createElement("iframe");return t.style.transition="opacity .2s",t.style.position="absolute",t.style.opacity="0",t.src=e,t},t.prototype.event=function(e){this._ready.then((function(t){e(t)}))},t.prototype.getBus=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,this._ready]}))}))},t.prototype.beforeShow=function(){this._showIframe()},t.prototype.afterShow=function(){this._hideIframe()},t.prototype._addIframeToDom=function(){var e=this;null!=document.body?document.body.appendChild(this._iframe):document.addEventListener("DOMContentLoaded",(function(){document.body.appendChild(e._iframe)}))},t.prototype._showIframe=function(){var e=this;this._applyStyle({width:"100%",height:"100%",left:"0",top:"0",border:"none",position:"fixed",display:"block",opacity:"0",zIndex:"99999999"}),null!=t._timer&&clearTimeout(t._timer),t._timer=setTimeout((function(){e._applyStyle({opacity:"1"})}),0)},t.prototype._hideIframe=function(){var e=this;this._applyStyle({opacity:"0"}),null!=t._timer&&clearTimeout(t._timer),t._timer=setTimeout((function(){e._applyStyle({width:"10px",height:"10px",left:"-100px",top:"-100px",position:"absolute",opacity:"0",zIndex:"0",display:"none"})}),200)},t.prototype._applyStyle=function(e){var t=this;Object.entries(e).forEach((function(e){var n=e[0],r=e[1];null!=r&&(t._iframe.style[n]=r)}))},t._timer=null,t}(o.Transport);t.TransportIframe=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){this.actions=[],this.maxLength=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.actions.length+(null==this.active?0:1)},enumerable:!0,configurable:!0}),e.prototype.push=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t=this;return r.__generator(this,(function(n){if(this.actions.length>=this.maxLength)throw new Error("Cant't push action! Queue is full!");return[2,new Promise((function(n,o){t.actions.push((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,e().then((function(e){return n(e)}),o)]}))}))})),1===t.length&&t.run()}))]}))}))},e.prototype.canPush=function(){return this.actions.length<this.maxLength},e.prototype.run=function(){var e=this,t=this.actions.shift();null!=t&&(this.active=t(),this.active.finally((function(){e.active=void 0;var n=e.actions.indexOf(t);-1!==n&&e.actions.splice(n,1),e.run()})))},e}();t.Queue=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);!function(e){e[e.Event=0]="Event",e[e.Action=1]="Action",e[e.Response=2]="Response"}(t.EventType||(t.EventType={})),function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(t.ResponseStatus||(t.ResponseStatus={}));var o=function(){function e(e,t){var n=this;this.id=r.uniqueId("bus"),this._timeout=t||5e3,this._adapter=e,this._adapter.addListener((function(e){return n._onMessage(e)})),this._eventHandlers=Object.create(null),this._activeRequestHash=Object.create(null),this._requestHandlers=Object.create(null),r.console.info('Create Bus with id "'+this.id+'"')}return e.prototype.dispatchEvent=function(t,n){return this._adapter.send(e._createEvent(t,n)),r.console.info('Dispatch event "'+t+'"',n),this},e.prototype.request=function(e,t,n){var o=this;return new Promise((function(i,s){var a,u=r.uniqueId(o.id+"-action"),c=n||o._timeout;-1!==(n||o._timeout)&&(a=setTimeout((function(){delete o._activeRequestHash[u];var t=new Error('Timeout error for request with name "'+e+'" and timeout '+c+"!");r.console.error(t),s(t)}),c));var f=function(){a&&clearTimeout(a)};o._activeRequestHash[u]={reject:function(t){f(),r.console.error('Error request with name "'+e+'"',t),s(t)},resolve:function(t){f(),r.console.info('Request with name "'+e+'" success resolved!',t),i(t)}},o._adapter.send({id:u,type:1,name:e,data:t}),r.console.info('Request with name "'+e+'"',t)}))},e.prototype.on=function(e,t,n){return this._addEventHandler(e,t,n,!1)},e.prototype.once=function(e,t,n){return this._addEventHandler(e,t,n,!0)},e.prototype.off=function(e,t){var n=this;return e?this._eventHandlers[e]?t?(this._eventHandlers[e]=this._eventHandlers[e].filter((function(e){return e.handler!==t})),this._eventHandlers[e].length||delete this._eventHandlers[e],this):(this._eventHandlers[e].slice().forEach((function(t){n.off(e,t.handler)})),this):this:(Object.keys(this._eventHandlers).forEach((function(e){return n.off(e,t)})),this)},e.prototype.registerRequestHandler=function(e,t){if(this._requestHandlers[e])throw new Error("Duplicate request handler!");return this._requestHandlers[e]=t,this},e.prototype.unregisterHandler=function(e){return this._requestHandlers[e]&&delete this._requestHandlers[e],this},e.prototype.changeAdapter=function(t){var n=this,r=new e(t,this._timeout);return Object.keys(this._eventHandlers).forEach((function(e){n._eventHandlers[e].forEach((function(t){t.once?r.once(e,t.handler,t.context):r.on(e,t.handler,t.context)}))})),Object.keys(this._requestHandlers).forEach((function(e){r.registerRequestHandler(e,n._requestHandlers[e])})),r},e.prototype.destroy=function(){r.console.info("Destroy Bus"),this.off(),this._adapter.destroy()},e.prototype._addEventHandler=function(e,t,n,r){return this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push({handler:t,once:r,context:n}),this},e.prototype._onMessage=function(e){switch(e.type){case 0:r.console.info('Has event with name "'+String(e.name)+'"',e.data),this._fireEvent(String(e.name),e.data);break;case 1:r.console.info('Start action with id "'+e.id+'" and name "'+String(e.name)+'"',e.data),this._createResponse(e);break;case 2:r.console.info('Start response with name "'+e.id+'" and status "'+e.status+'"',e.content),this._fireEndAction(e)}},e.prototype._createResponse=function(t){var n=this,o=function(e){r.console.error(e),n._adapter.send({id:t.id,type:2,status:1,content:String(e)})};if(this._requestHandlers[String(t.name)])try{var i=this._requestHandlers[String(t.name)](t.data);e._isPromise(i)?i.then((function(e){n._adapter.send({id:t.id,type:2,status:0,content:e})}),o):this._adapter.send({id:t.id,type:2,status:0,content:i})}catch(e){o(e)}else o(new Error('Has no handler for "'+String(t.name)+'" action!'))},e.prototype._fireEndAction=function(e){if(this._activeRequestHash[e.id]){switch(e.status){case 1:this._activeRequestHash[e.id].reject(e.content);break;case 0:this._activeRequestHash[e.id].resolve(e.content)}delete this._activeRequestHash[e.id]}},e.prototype._fireEvent=function(e,t){this._eventHandlers[e]&&(this._eventHandlers[e]=this._eventHandlers[e].slice().filter((function(e){try{e.handler.call(e.context,t)}catch(e){r.console.warn(e)}return!e.once})),this._eventHandlers[e].length||delete this._eventHandlers[e])},e._createEvent=function(e,t){return{type:0,name:e,data:t}},e._isPromise=function(e){return e&&e.then&&"function"==typeof e.then},e}();t.Bus=o},function(e,t,n){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=n(2),s=(self||e).console,a=Object.create(null);function u(e){a[e]||(a[e]=[])}function c(e,t){a[e].push(t)}t.console=r({},i.keys(o.config.console.methodsData).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];o.config.console.logLevel<o.config.console.methodsData[t].logLevel?o.config.console.methodsData[t].save&&(u(t),c(t,e)):s[t].apply(s,e)},e}),Object.create(null)),{getSavedMessages:function(e){return a[e]||[]}})}).call(this,n(14))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.size=0,this.hash=Object.create(null),e&&e.forEach(this.add,this)}return e.prototype.add=function(e){return this.hash[e]=!0,this.size=Object.keys(this.hash).length,this},e.prototype.has=function(e){return e in this.hash},e.prototype.toArray=function(){return Object.keys(this.hash)},e}();t.UniqPrimitiveCollection=r},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),a=n(1),u=n(7),c=n(2),f={origins:[],availableChanelId:[]},l=function(e){function t(n,r,o){var i=e.call(this)||this;return i.id=a.uniqueId("wa"),i.callbacks=[],i.options=t.prepareOptions(o),i.listen=n,i.dispatch=r,i.listen.forEach((function(e){return e.on("message",i.onMessage,i)})),i}return o(t,e),t.prototype.addListener=function(e){return this.callbacks.push(e),a.console.info("WindowAdapter: Add iframe message listener"),this},t.prototype.send=function(e){var t=i({},e,{chanelId:this.options.chanelId});return this.dispatch.forEach((function(e){return e.dispatch(t)})),a.console.info("WindowAdapter: Send message",t),this},t.prototype.destroy=function(){this.listen.forEach((function(e){return e.destroy()})),this.dispatch.forEach((function(e){return e.destroy()})),a.console.info("WindowAdapter: Destroy")},t.prototype.onMessage=function(e){this.accessEvent(e)&&this.callbacks.forEach((function(t){try{t(e.data)}catch(e){a.console.warn("WindowAdapter: Unhandled exception!",e)}}))},t.prototype.accessEvent=function(e){if("object"!=typeof e.data||null==e.data.type)return a.console.info("WindowAdapter: Block event. Wrong event format!",e.data),!1;if(!this.options.origins.has("*")&&!this.options.origins.has(e.origin))return a.console.info('SimpleWindowAdapter: Block event by origin "'+e.origin+'"'),!1;if(!this.options.availableChanelId.size)return!0;var t=!(!e.data.chanelId||!this.options.availableChanelId.has(e.data.chanelId));return t||a.console.info('SimpleWindowAdapter: Block event by chanel id "'+e.data.chanelId+'"'),t},t.createSimpleWindowAdapter=function(e,n){var r=this,o=this.getContentOrigin(e),i=this.prepareOptions(n),s=[];o&&i.origins.add(o);var a=new u.WindowProtocol(window,u.WindowProtocol.PROTOCOL_TYPES.LISTEN),c=function(e){s.push(e)};return a.on("message",c),this.getIframeContent(e).then((function(e){var n=new u.WindowProtocol(e.win,u.WindowProtocol.PROTOCOL_TYPES.DISPATCH),o=new t([a],[n],r.unPrepareOptions(i));return s.forEach((function(e){o.onMessage(e)})),a.off("message",c),o}))},t.prepareOptions=function(e){void 0===e&&(e=f);var t=function(e,t){return c.pipe(a.toArray,(n=t,function(e){return e.reduce((function(e,t){return e.add(t)}),n)}))(e);var n},n=t(e.origins||[],new a.UniqPrimitiveCollection([window.location.origin])),r=t(e.availableChanelId||[],new a.UniqPrimitiveCollection);return i({},e,{origins:n,availableChanelId:r})},t.unPrepareOptions=function(e){return{origins:e.origins.toArray(),availableChanelId:e.availableChanelId.toArray(),chanelId:e.chanelId}},t.getIframeContent=function(e){return e?e instanceof HTMLIFrameElement?e.contentWindow?Promise.resolve({win:e.contentWindow}):new Promise((function(t,n){e.addEventListener("load",(function(){return t({win:e.contentWindow})}),!1),e.addEventListener("error",n,!1)})):Promise.resolve({win:e}):Promise.resolve({win:window.opener||window.parent})},t.getContentOrigin=function(e){if(!e)try{return new URL(document.referrer).origin}catch(e){return null}if(!(e instanceof HTMLIFrameElement))try{return window.top.origin}catch(e){return null}try{return new URL(e.src).origin||null}catch(e){return null}},t}(s.Adapter);t.WindowAdapter=l},function(e,t,n){"use strict";t.__esModule=!0,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(18))},function(e,t,n){"use strict";t.__esModule=!0;var r=function(){function e(){this._events=Object.create(null)}return e.prototype.hasListeners=function(e){return!(!this._events[e]||!this._events[e].length)},e.prototype.getActiveEvents=function(){var e=this;return Object.keys(this._events).filter((function(t){return e.hasListeners(t)}))},e.prototype.trigger=function(e,t){this._events[e]&&(this._events[e]=this._events[e].filter((function(e){try{e.handler.call(e.context,t)}catch(e){}return!e.once})),this._events[e].length||delete this._events[e])},e.prototype.on=function(e,t,n){this._on(e,t,n,!1)},e.prototype.once=function(e,t,n){this._on(e,t,n,!0)},e.prototype.off=function(e,t){var n=this,r="string"==typeof e?e:null,o="function"==typeof t?t:"function"==typeof e?e:null;r?o?r in this._events&&(this._events[r]=this._events[r].filter((function(e){return e.handler!==o}))):delete this._events[r]:Object.keys(this._events).forEach((function(e){n.off(e,o)}))},e.prototype._on=function(e,t,n,r){this._events[e]||(this._events[e]=[]),this._events[e].push({handler:t,context:n,once:r})},e}();t.EventEmitter=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(3),i=n(1),s=function(e){function t(t,n){var r=e.call(this,n)||this;return r._url=t,r}return r.__extends(t,e),t.prototype.event=function(e){this._messageCallback=e},t.prototype.beforeShow=function(){},t.prototype.afterShow=function(){null!=this._active&&(this._active.win.close(),this._active.bus.destroy()),this._active=void 0},t.prototype.getBus=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,o,s=this;return r.__generator(this,(function(r){switch(r.label){case 0:if(null!=this._active)return[2,Promise.resolve(this._active.bus)];if(e=window.open(this._url),t=new URL("",this._url).origin,null==e)throw new Error("Method must be called in user event!");return[4,i.WindowAdapter.createSimpleWindowAdapter(e,{origins:t})];case 1:return n=r.sent(),o=new i.Bus(n,-1),this._active={win:e,bus:o},[2,new Promise((function(e){o.once("ready",(function(){null!=s._messageCallback&&s._messageCallback(o),e()}))}))]}}))}))},t}(o.Transport);t.TransportWindow=s}])}])}));